<!DOCTYPE html>

<html lang="en">

<!--
		Adapted from rubiks_cube
-->

<head>

	<title>three.js example 01 &mdash; Basic skeleton</title>

	<meta charset="utf-8">

	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

	<style>
		body {

			background-color: #000000;

			/* To use the complete page */

			margin: 0px;

			overflow: hidden;
		}
	</style>

</head>

<body>

	<!-- The library --- Can be a local version -->

	<script type="text/javascript" src="http://threejs.org/build/three.js"></script>

	<!-- Javascript code that runs the Three.js example -->

	<script type="text/javascript">

		function createSponge(scene,cube,limit){

			var height= cube.geometry.parameters.height;
			var width = cube.geometry.parameters.width;
			var depth = cube.geometry.parameters.depth;

			// The Geometry
			var geometry = new THREE.BoxBufferGeometry(height/3, width/3, depth/3);
			// The material
		    	var material = new THREE.MeshBasicMaterial({
				color: 0xd4d4d4,
		    	});
			var material2 = new THREE.MeshBasicMaterial({
				color: 0x000000,
				wireframe: true
		   	 });

			//we will subdivide our cube (called mother cube later) in 27 mini cubes
			for (var z = -1; z <= 1; z ++) {
				for (var x = -1; x <= 1; x ++) {
					for (var y = -1; y <= 1; y ++) {
						//when one of the three axis is 0 we dont want to add a cube
						if(!((z==0 && x==0) || (z==0 && y==0) || (x==0 && y==0))){
							//We will create a "mini cube" of the mother cube						
							var cube2 = new THREE.Mesh(geometry, material);
							cube2.position.x = cube.position.x+(width/3)*x;
							cube2.position.y = cube.position.y+(height/3)*y;
							cube2.position.z = cube.position.z+(depth/3)*z;

							if(limit>0){
								createSponge(scene,cube2,limit-1)
							}
							else{
								//stop recursivity
								var wireCube = new THREE.Mesh(geometry, material2);
								wireCube.position.x = cube.position.x+(width/3)*x;
								wireCube.position.y = cube.position.y+(height/3)*y;
								wireCube.position.z = cube.position.z+(depth/3)*z;

								scene.add(cube2);
								scene.add(wireCube);
							}
						}
					}
				}
			}

		}

		// Once everything is loaded, init is loaded
		function init() {
			// The Scene
		    var scene = new THREE.Scene();

				// The Geometry
				var geometry = new THREE.BoxBufferGeometry(10, 10, 10);
				// The material
		    var material = new THREE.MeshBasicMaterial({
			color: 0xd4d4d4,
		    });

				var cube = new THREE.Mesh(geometry, material);

				//create sponge
				createSponge(scene,cube,3);

				// The CAMERA --- A camera is added to the scene

		    // --- Where the viewer is and how he is looking at the scene

		    var camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, 1000);

		    camera.position.z = 0;
				camera.position.y = 10;
				camera.position.x = 15;

		    // Point the camera to the center of the scene

		    camera.lookAt(scene.position);

		    scene.add(camera)

		    // The RENDERER --- To display the scene on the Web page

		    var renderer = new THREE.WebGLRenderer({
			antialias: true
		    });

		    renderer.setClearColor(new THREE.Color(0xffffff));

		    renderer.setPixelRatio(window.devicePixelRatio);

		    renderer.setSize(window.innerWidth, window.innerHeight);

		    // Add the output of the renderer

		    document.body.appendChild(renderer.domElement);

		    // Render the scene

		    renderer.render(scene, camera);
		}

		window.onload = init

	</script>

</body>

</html>
